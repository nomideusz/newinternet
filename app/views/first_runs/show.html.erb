<% @page_title = "Set up New Internet" %>
<% @body_class = "signup" %>

<div class="center max-width"
     data-controller="webauthn"
     data-webauthn-mode-value="firstrun"
     data-webauthn-options-url-value="<%= first_run_options_path %>"
     data-webauthn-callback-url-value="<%= first_run_path %>">

  <section class="nametag u-relative">
    <div class="flex justify-center align-center pad-block">
      <%= image_tag "lanyard.svg", class: "nametag__lanyard", aria: { hidden: "true" } %>
    </div>

    <form data-action="submit->webauthn#authenticate" class="nametag__inner flex flex-column gap">
      <fieldset class="flex flex-column center-block">
        <legend class="txt-large txt-align-center"><strong><%= @page_title %></strong></legend>

        <p class="txt-danger txt-align-center" data-webauthn-target="error" hidden></p>



        <div class="flex align-center gap margin-block-start">
          <%= translation_button(:username) %>
          <label class="flex align-center gap flex-item-grow txt-large input input--actor">
            <input type="text"
                   name="username"
                   class="input"
                   autocomplete="username"
                   placeholder="Choose a username"
                   required
                   pattern="[a-z0-9_]+"
                   title="Lowercase letters, numbers, and underscores only"
                   data-webauthn-target="username">
            <span class="txt-muted">@</span>
          </label>
        </div>

        <div class="flex align-center gap margin-block-start">
          <%= translation_button(:name) %>
          <label class="flex align-center gap flex-item-grow txt-large input input--actor">
            <input type="text"
                   name="name"
                   class="input"
                   autocomplete="name"
                   placeholder="Your display name"
                   data-webauthn-target="name">
            <%= image_tag "person.svg", aria: { hidden: "true" }, size: 20, class: "colorize--black" %>
          </label>
        </div>

        <p class="txt-small txt-muted txt-align-center margin-block">
          Your device will prompt you to create a passkey.<br>
          This replaces passwords â€” just use Face ID, Touch ID, or your device PIN.
        </p>

        <button class="btn btn--reversed center txt-large"
                type="submit"
                data-webauthn-target="submit">
          <%= image_tag "arrow-right.svg", aria: { hidden: "true" } %>
          <span>Create Account with Passkey</span>
        </button>
      </fieldset>
    </form>
  </section>
</div>
